<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>ViverSantarém App</title>
  <link rel='stylesheet' href='https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css'>
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css'><link rel="stylesheet" href="./style.css">

</head>


<style>
svg{
  margin-left:5px;
  margin-right:10px;
  margin-top:0px;
  width:40px;
  height:40px;
  
  display:block;
}
#water #waveShape {
  animation-name: waveAction01;
  animation-iteration-count: infinite;
  animation-timing-function: linear;
  animation-duration: 2s;
}

@keyframes waveAction01 {
  0% {
    transform: translate(300px, -1830px);
  }
  100% {
    transform: translate(102px, -1830px);
  }
}
</style>
<nav class="navbar navbar-expand-lg navbar-light bg-light">
 
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="211" height="211" viewBox="0 0 211 211">
  <defs>
    <clipPath id="clip-path">
      <circle id="mask" cx="105.5" cy="105.5" r="105.5" transform="translate(312 -1822)" fill="#fff" stroke="#707070" stroke-width="1"/>
    </clipPath>
  </defs>
  <g id="circle" transform="translate(-312 1822)">
    <g id="bg" transform="translate(312 -1822)" fill="#fff" stroke="#707070" stroke-width="1">
      <circle cx="105.5" cy="105.5" r="105.5" stroke="none"/>
      <circle cx="105.5" cy="105.5" r="105" fill="none"/>
    </g>
    <g id="water" clip-path="url(#clip-path)">
      <path id="waveShape" d="M500,118.244v223.11H4V106.464c43.35,1.17,46.02,11.89,94.4,11.89,51.2,0,51.2-12,102.39-12s51.2,12,102.4,12,51.2-12,102.41-12C453.98,106.354,456.65,117.074,500,118.244Z" transform="translate(308 -1830.354)" fill="#04acff"/>
    </g>
  </g>
</svg>


  <a style="margin-right:50%;" class="navbar-brand" href="#">ViverSantarém</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">

    <ul class="navbar-nav mr-auto">
      <li class="nav-item ">
        <a class="nav-link" href="#">Plataforma </a>
      </li>
      <li class="nav-item active">
        <a class="nav-link" href="#">Modelos</a><span class="sr-only">(current)</span>
      </li>
	  <li class="nav-item">
        <a class="nav-link" href="#">Manutenções</a>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Configurações
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="#">Locais</a>
          <a class="dropdown-item" href="#">Operações</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="#">Instalações</a>
        </div>
      </li>

    </ul>
    
  </div>
</nav>






<body>
<!-- partial:index.partial.html -->
<div class="justify-content-center align-items-center" style="padding-bottom:25px;">
  <div style="padding-top: 50px; text-align:center;">
    <div>
      <h3>Modelo de Manutenção</h3>
      <h4>Complexo Aquático / Piscinas Sacapeito</h4>
    </div>
   
</div>

<br>
 <form class="needs-validation" novalidate action="" method="post">
      <div class="form-row">
        <div class="col-md-2 mb-3">
          <label for="validationTooltip01">Nome do Modelo</label>
          <input type="text" class="form-control" id="validationTooltip01" placeholder="" value="" required>
        </div>
        
<button style="height:40px;margin:30px 0px 0px 50px;font-size:14px" class="btn btn-primary btn-sm" type="submit">Guardar  Modelo</button>
 </div>

</form>  


<!-- DISPLAY USER SCHEDULER-->
<div class="table-responsive">
  <div data-parse="1595877840000" id="calplaceholder" style="max-height: 500px; margin-bottom: 0;">
    <div class="cal-sectionDiv">
      <table style="width:64%;float:left" class="table table-striped table-bordered">


        <tbody class="cal-tbody">
          <tr id="h16">
<td class="cal-usersheader_local" style="color:#000; background-color:#389fe8; padding:0px;">Local </td>
<td class="cal-usersheader_opera" style="color:#000; background-color:#389fe8; padding:0px;">Operação</td> 
<td class="cal-usersheader_obs" style="color:#000; background-color:#389fe8; padding:0px;">A Observar</td>

          </tr>
          <tr id="u1">  
<td class="ui-droppable" data-date="1" data-userid="1">
<div class="drag details ui-draggable ui-draggable-handle" data-taskid="13956" data-userid="1" style="border-left: 5px solid rgb(81, 255, 0); position: relative;">
<div class="details-uren">Nave Principal</div>
</div>
</td>

<td class="ui-droppable" data-date="2/7/2020" data-userid="1">
<div class="drag details ui-draggable ui-draggable-handle" data-taskid="13957" data-userid="1" style="border-left: 5px solid rgb(121, 32, 32); position: relative;">
<h3 class="details-task" style=" background: #792020; color: #FFFFFF">Retirar Robot da piscina e arrumar</h3>
<div class="horas">00:00</div>
              </div>
</td>
            
<td class="ui-droppable" >
<h3 style="border-left: 5px solid rgb(255, 184, 72); position: relative;" class="details-task" style=" background: #FFB848; color: #000000">Lavar o saco do Robot</h3>
</td>
</tr>
          
          
<tr id="u2">
<td class="ui-droppable" data-date="1" data-userid="1">
<div class="drag details ui-draggable ui-draggable-handle" data-taskid="13956" data-userid="1" style="border-left: 5px solid rgb(81, 255, 0); position: relative;">
<div class="details-uren">Caldeiras</div>
</div>
</td>
                        
<td class="ui-droppable" data-date="2/7/2020" data-userid="2">
<div class="drag details ui-draggable ui-draggable-handle" data-taskid="12326" data-userid="2" style="border-left: 5px solid rgb(36, 115, 171); position: relative;">
<h3 class="details-task" style=" background: #2473AB; color: #FFFFFF">Verificar temperatura dos depósitos</h3>
<div class="horas">00:00</div>
</div>
</td>

<td class="ui-droppable" >
<h3 style="border-left: 5px solid rgb(255, 184, 72); position: relative;" class="details-task" style=" background: #FFB848; color: #000000">Termómetros das termoestáticas 35/40°C</h3>
</td>     
</tr>

<tr id="u3">
 <td class="ui-droppable" data-date="1" data-userid="1">
 <div class="drag details ui-draggable ui-draggable-handle" data-taskid="13956" data-userid="1" style="border-left: 5px solid rgb(81, 255, 0); position: relative;">
<div class="details-uren">Piso -1</div>
</div>
</td>
            
<td class="ui-droppable" data-date="3/7/2020" data-userid="3">
<div class="drag details ui-draggable ui-draggable-handle" data-taskid="12266" data-userid="3" style="border-left: 5px solid rgb(36, 115, 171); position: relative;">
<h3 class="details-task" style=" background: #2473AB; color: #FFFFFF">Fazer Análises Piscina Desportiva</h3>
<div class="horas">00:00</div>
</div>
</td>
            
<td class="ui-droppable" >
<h3 style="border-left: 5px solid rgb(255, 184, 72); position: relative;" class="details-task" style=" background: #FFB848; color: #000000">Registo Próprio</h3>
</td>
</tr>
          
          <tr id="u4">
            <td class="ui-droppable" data-date="1" data-userid="1">
              <div class="drag details ui-draggable ui-draggable-handle" data-taskid="13956" data-userid="1" style="border-left: 5px solid rgb(81, 255, 0); position: relative;">
      <div class="details-uren">Piso 0
                </div>
              </div>
            </td>
            
            <td class="ui-droppable" data-date="2/7/2020" data-userid="4">
              <div class="drag details ui-draggable ui-draggable-handle" data-taskid="13954" data-userid="4" style="border-left: 5px solid rgb(126, 126, 126); position: relative;">
                <h3 class="details-task" style=" background: #7E7E7E; color: #FFFFFF">Registar no quadro do corredor os indicadores analícos</h3>
                 <div class="horas">00:00</div>
              </div>
            </td>

<td class="ui-droppable" >
<h3 style="border-left: 5px solid rgb(255, 184, 72); position: relative;" class="details-task" style=" background: #FFB848; color: #000000">PH, Cloro e Temp. (Pisc. Aprend. e Chap. Int.)</h3>
</td>            
</tr>
          
          
          <tr id="u5">
            <td class="ui-droppable" data-date="1" data-userid="1">
              <div class="drag details ui-draggable ui-draggable-handle" data-taskid="13956" data-userid="1" style="border-left: 5px solid rgb(81, 255, 0); position: relative;">
      <div class="details-uren">Outras
                </div>
              </div>
            </td>
            
            
            
            <td class="ui-droppable" data-date="2/7/2020" data-userid="5">
              <div class="drag details ui-draggable ui-draggable-handle" data-taskid="12550" data-userid="5" style="border-left: 5px solid rgb(36, 115, 171); position: relative;">
                <h3 class="details-task" style=" background: #2473AB; color: #FFFFFF">Retirar leitura do contador de Gás</h3>
                 <div class="horas">00:00</div>
              </div>
            </td>
            
<td class="ui-droppable" >
<h3 style="border-left: 5px solid rgb(255, 184, 72); position: relative;" class="details-task" style=" background: #FFB848; color: #000000">Digital / Analógico</h3>
</td>
        </tr>
          
 <tr style="height:50px" id="u6">         
<td class="ui-droppable" data-date="6/7/2020" data-userid="8">
</td>

<td class="ui-droppable" data-date="7/7/2020" data-userid="8">
</td>

<td class="ui-droppable" data-date="8/7/2020" data-userid="8">
</td>
</tr>           

 <tr style="height:50px" id="u6">         
<td class="ui-droppable" data-date="6/7/2020" data-userid="8">
</td>

<td class="ui-droppable" data-date="7/7/2020" data-userid="8">
</td>

<td class="ui-droppable" data-date="8/7/2020" data-userid="8">
</td>
</tr>  
 
          
        </tbody>
      </table>
      
      
      
<!--Inicio Tabela-->
<div style="width:34%;float:right">      
<table  class="table-striped table-bordered">
<tbody class="cal-tbody">

 <ul class="nav nav-pills " id="pills-tab" role="tablist">
   
  <li class="nav-item" role="presentation">
    <a class="nav-link active" id="pills-locais-tab" data-toggle="pill" href="#pills-locais" role="tab" aria-controls="pills-home" aria-selected="true">Locais</a>
  </li>
  <li class="nav-item" role="presentation">
    <a class="nav-link" id="pills-nave-tab" data-toggle="pill" href="#pills-nave" role="tab" aria-controls="pills-nave" aria-selected="false">Nave</a>
  </li>
  <li class="nav-item" role="presentation">
    <a class="nav-link" id="pills-contact-tab" data-toggle="pill" href="#pills-contact" role="tab" aria-controls="pills-contact" aria-selected="false">Piso -1</a>
  </li>
</ul>
  
  
<!--Inicio das Tabs-->              
<div class="tab-content" id="pills-tabContent">
  
<!--Inicio da Tab Locais-->  
  <div style="width:125px" class="tab-pane fade show active" id="pills-locais" role="tabpanel" aria-labelledby="pills-locais-tab">
<!--Local -->    
<div class="ui-droppable" data-date="2/7/2020" data-userid="2">
<div class="drag details ui-draggable ui-draggable-handle" data-taskid="12326" data-userid="2" style="border-left: 5px solid rgb(81, 255, 0); position: relative;">
<h3 class="details-task" style="color: #000000">Nave Principal</h3>
 </div>
</div> <!--Fim do Local-->

<!--Local -->    
<div class="ui-droppable" data-date="2/7/2020" data-userid="2">
<div class="drag details ui-draggable ui-draggable-handle" data-taskid="12326" data-userid="2" style="border-left: 5px solid rgb(81, 255, 0); position: relative;">
<h3 class="details-task" style=" color: #000000">Caldeiras</h3>
 </div>
</div> <!--Fim do Local-->
    
<!--Local -->    
<div class="ui-droppable" data-date="2/7/2020" data-userid="2">
<div class="drag details ui-draggable ui-draggable-handle" data-taskid="12326" data-userid="2" style="border-left: 5px solid rgb(81, 255, 0); position: relative;">
<h3 class="details-task" style="color: #000000">Piso -1</h3>
 </div>
</div> <!--Fim do Local-->
 
<!--Local -->    
<div class="ui-droppable" data-date="2/7/2020" data-userid="2">
<div class="drag details ui-draggable ui-draggable-handle" data-taskid="12326" data-userid="2" style="border-left: 5px solid rgb(81, 255, 0); position: relative;">
<h3 class="details-task" style="color: #000000">Piso 0</h3>
 </div>
</div> <!--Fim do Local-->
<!--Local -->    
<div class="ui-droppable" data-date="2/7/2020" data-userid="2">
<div class="drag details ui-draggable ui-draggable-handle" data-taskid="12326" data-userid="2" style="border-left: 5px solid rgb(81, 255, 0); position: relative;">
<h3 class="details-task" style="color: #000000">Outras</h3>
 </div>
</div> <!--Fim do Local--> 
    
<!--Local -->    
<div class="ui-droppable" data-date="2/7/2020" data-userid="2">
<div class="drag details ui-draggable ui-draggable-handle" data-taskid="12326" data-userid="2" style="border-left: 5px solid rgb(81, 255, 0); position: relative;">
<h3 class="details-task" style="color: #000000">Complexo Aquático</h3>
 </div>
</div> <!--Fim do Local-->
    
<!--Local -->    
<div class="ui-droppable" data-date="2/7/2020" data-userid="2">
<div class="drag details ui-draggable ui-draggable-handle" data-taskid="12326" data-userid="2" style="border-left: 5px solid rgb(81, 255, 0); position: relative;">
<h3 class="details-task" style="color: #000000">Sacapeito</h3>
 </div>
</div> <!--Fim do Local-->      
</div> <!--Fim da Tab Locais-->
  
  
  
  
 <!--Inicio da Tab Nave-->  
  <div class="tab-pane fade" id="pills-nave" role="tabpanel" aria-labelledby="pills-nave-tab">
<!--Operação -->    
<div class="ui-droppable" data-date="2/7/2020" data-userid="2">
<div class="drag details ui-draggable ui-draggable-handle" data-taskid="12326" data-userid="2" style="border-left: 5px solid rgb(36, 115, 171); position: relative;">
<h3 class="details-task" style=" background: #2473AB; color: #FFFFFF">Retirar Robot da piscina e arrumar</h3>
<div class="horas">00:00</div>
 </div>
</div> <!--Fim da Operação-->

<!--Operação -->    
<div class="ui-droppable" data-date="2/7/2020" data-userid="2">
<div class="drag details ui-draggable ui-draggable-handle" data-taskid="12326" data-userid="2" style="border-left: 5px solid rgb(36, 115, 171); position: relative;">
<h3 class="details-task" style=" background: #2473AB; color: #FFFFFF">Limpar piscinas com camaroeiro e limpeza do cais</h3>
<div class="horas">00:00</div>
 </div>
</div> <!--Fim da Operação-->
    
<!--Operação -->    
<div class="ui-droppable" data-date="2/7/2020" data-userid="2">
<div class="drag details ui-draggable ui-draggable-handle" data-taskid="12326" data-userid="2" style="border-left: 5px solid rgb(36, 115, 171); position: relative;">
<h3 class="details-task" style=" background: #2473AB; color: #FFFFFF">Encher lava-pés</h3>
<div class="horas">00:00</div>
 </div>
</div> <!--Fim da Operação-->      
</div>  <!--Fim da TAB Operações-->  
  
  
  
  <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">3333
  
  
</div>
</div>
        

</tbody>
      </table>     
      </div>      
      
      
      
      
      
    </div>
  </div>
</div>

<!--MODAL: EDITAR -->
<div class="modal fade" id="edittask" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Editar</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div id="modal-edit" class="modal-body">
        <div class="input-group">
          
           <div class="form-group" style="width:125px; margin-left:15px; margin-right:5px;">
            <label for="cono1" class="col-sm-3 text-left control-label col-form-label" style="padding-left: 0px;"><b>Hora:</b></label>
            <input id="date" class="form-control taskstart" placeholder="00:00" type="time">
          </div>         
          
          
<div class="form-group" style="width:125px; margin-left:15px; margin-right:5px;">
<label for="cono1" class="col-sm-3 text-left control-label col-form-label" style="padding-left: 0px;"><b>Texto:</b></label>
            <input type="text" id="ktxt" data-jscolor="" class="form-control" name="ctxt" value="" onchange="changeColor('ctxt', this.value);">
          </div>
          <div class="form-group" style="width:125px; margin-left:5px; margin-right:5px;">
            <label for="cono1" class="col-sm-3 text-left control-label col-form-label" style="padding-left: 0px;"><b>Fundo:</b></label>
            <input type="text" id="kbg" data-jscolor="" class="form-control" name="cbg" value="" onchange="changeColor('cbg', this.value);">
          </div>
          <div class="form-group" style="width:175px; margin-left:5px;">

            <div id="demotaak1" data-taskid="3" class="form-control details" style="border-left:5px solid #959595; position:relative; height: 50px;">
              <h3 id="demotaak2" class="details-task" style="background:#959595; color:#FFFFFF">Exemplo</h3>
              <p class="details-uren">08:00</p>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
        <button type="button" class="btn btn-primary">Guardar Alterações</button>
      </div>
    </div>
  </div>
</div>
</div>

<!-- MODAL: ELIMINAR -->
<div class="modal fade" id="deletetask" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">

      <div id="modal-delete" class="modal-body" style="text-align: center;">
      </div>
      <div class="modal-footer">
        <input id="taskdelid" type="hidden" value="">
        <button type="button" class="btn btn-warning" data-dismiss="modal">Cancelar</button>
        <button id="confdelete" type="button" class="btn btn-danger">Sim</button>

      </div>
    </div>
  </div>
</div>
<!-- partial -->
  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js'></script>
<script src='https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jscolor/2.3.3/jscolor.min.js'></script>


<script>
// Drag tasks around
$(".drag").draggable({
  revert: "invalid",
  start: function (e, ui) {
    // Date from where task was dragged from
    $(this).data("oldDate", $(this).parent().data("date"));
  }
});

// Select drop area for Tasks (only droppable on TD which have "data-date" attribute)
$("td[data-date]").droppable({
  drop: function (e, ui) {
    var drag = ui.draggable,
      drop = $(this),
      oldDate = drag.data("oldDate"), // Task date on drag
      newDate = drop.data("date"), // Task date on drop
      dragID = drag.data("userid"), // Task userid on drag
      dropID = drop.data("userid"); // Task userid on drop
    if (oldDate != newDate || dragID != dropID) {
      $(drag).detach().css({ top: 0, left: 0 }).appendTo(drop);
      $(drag).data("userid", dropID); // Update task userid
    } else {
      return $(drag).css({ top: 0, left: 0 }); // Return task to old position
    }
  }
});

// show EDIT and TRASH tools
$(".drag").hover(
  function () {
    var isAdmin = 1; // Ability to hide or show edit and delete options
    if (isAdmin == 1) {
      $(this)
        .css("z-index", "999")
        .prepend(
          '<div class="opt-tools"><div class="opt-edit"><i class="fas fa-pen"></i></div><div class="opt-trash"><i class="fas fa-trash"></i></div></div>'
        );
    }
  },
  function () {
    //When mouse hovers out DIV remove tools
    $(this).css("z-index", "0").find(".opt-tools").remove();
  }
);

// Show modal to edit task
$(document).on("click", ".opt-edit", function () {
  // Get task ID and DATE from DATA attribute
  var taskid = $(this).parent().parent().data("taskid"),
    userid = $(this).parent().parent().data("userid");
  // Get DATE
  var date = $(this).closest("td").data("date");
  // insert data to Modal
  $("#ktxt")[0].jscolor.fromString("FFFFFF");
  $("#kbg")[0].jscolor.fromString("8E8E8E");
  $("#demotaak2").css("color", "#FFFFFF");
  $("#demotaak1").css("border-left-color", "#8E8E8E");
  $("#demotaak2").css("background-color", "#8E8E8E");
  $("#edittask").modal("show");
});

// Modal remove task ?
$(document).on("click", ".opt-trash", function () {
  var taskid = $(this).parent().parent().data("taskid");

  $("#taskdelid").val(taskid);
  $("#modal-delete").html(
    "Tem a certeza que pretende eliminar o ID <b>" + taskid + "</b>?"
  );
  $("#deletetask").modal("show");
});

// Remove task after conformation
$(document).on("click", "#confdelete", function () {
  var taskid = $("#taskdelid").val();
  $("div")
    .find("[data-taskid=" + taskid + "]")
    .remove();
  $("#deletetask").modal("hide");
});

function changeColor(id, c) {
  if (id == "ctxt") {
    $("#demotaak2").css("color", "#" + c);
  } else if (id == "cbg") {
    $("#demotaak1").css("border-left-color", "#" + c);
    $("#demotaak2").css("background-color", "#" + c);
  }
  return false;
}









// Seleciona os elementos da Tab "Locais"
const tabLocais = document.querySelector('.tab-locais');  // A tab "Locais"
const dropZone = document.querySelector('.drop-zone');  // O alvo onde a tab será movida

// Evento de dragstart para armazenar os dados da tab "Locais" sem removê-los
tabLocais.addEventListener('dragstart', (event) => {
    // Guarda o conteúdo HTML da tab "Locais" no dataTransfer
    event.dataTransfer.setData('text', tabLocais.innerHTML);
    // Altera a opacidade da tab para mostrar que está sendo arrastada
    event.target.style.opacity = '0.5';
});

// Evento de dragend para restaurar a opacidade após o drag
tabLocais.addEventListener('dragend', (event) => {
    // Restaura a opacidade da tab "Locais" após o arraste
    event.target.style.opacity = '1';
});

// Permitir o drop ao adicionar um evento de dragover no alvo de drop
dropZone.addEventListener('dragover', (event) => {
    // Previne o comportamento padrão para permitir o drop
    event.preventDefault();
});

// Evento de drop para copiar o conteúdo da tab "Locais"
dropZone.addEventListener('drop', (event) => {
    // Previne o comportamento padrão do drop
    event.preventDefault();
    // Obtém os dados (HTML da tab "Locais") que foram armazenados no dragstart
    const data = event.dataTransfer.getData('text');
    // Adiciona os dados copiados no local de drop (alvo)
    dropZone.innerHTML += data;
});


</script>

<script>
// Drag tasks around
$(".drag").draggable({
  revert: "invalid",
  start: function (e, ui) {
    // Date from where task was dragged from
    $(this).data("oldDate", $(this).parent().data("date"));
  }
});

// Select drop area for Tasks (only droppable on TD which have "data-date" attribute)
$("td[data-date]").droppable({
  drop: function (e, ui) {
    var drag = ui.draggable,
      drop = $(this),
      oldDate = drag.data("oldDate"), // Task date on drag
      newDate = drop.data("date"), // Task date on drop
      dragID = drag.data("userid"), // Task userid on drag
      dropID = drop.data("userid"); // Task userid on drop
    if (oldDate != newDate || dragID != dropID) {
      $(drag).detach().css({ top: 0, left: 0 }).appendTo(drop);
      $(drag).data("userid", dropID); // Update task userid
    } else {
      return $(drag).css({ top: 0, left: 0 }); // Return task to old position
    }
  }
});

// show EDIT and TRASH tools
$(".drag").hover(
  function () {
    var isAdmin = 1; // Ability to hide or show edit and delete options
    if (isAdmin == 1) {
      $(this)
        .css("z-index", "999")
        .prepend(
          '<div class="opt-tools"><div class="opt-edit"><i class="fas fa-pen"></i></div><div class="opt-trash"><i class="fas fa-trash"></i></div></div>'
        );
    }
  },
  function () {
    //When mouse hovers out DIV remove tools
    $(this).css("z-index", "0").find(".opt-tools").remove();
  }
);

// Show modal to edit task
$(document).on("click", ".opt-edit", function () {
  // Get task ID and DATE from DATA attribute
  var taskid = $(this).parent().parent().data("taskid"),
    userid = $(this).parent().parent().data("userid");
  // Get DATE
  var date = $(this).closest("td").data("date");
  // insert data to Modal
  $("#ktxt")[0].jscolor.fromString("FFFFFF");
  $("#kbg")[0].jscolor.fromString("8E8E8E");
  $("#demotaak2").css("color", "#FFFFFF");
  $("#demotaak1").css("border-left-color", "#8E8E8E");
  $("#demotaak2").css("background-color", "#8E8E8E");
  $("#edittask").modal("show");
});

// Modal remove task ?
$(document).on("click", ".opt-trash", function () {
  var taskid = $(this).parent().parent().data("taskid");

  $("#taskdelid").val(taskid);
  $("#modal-delete").html(
    "Tem a certeza que pretende eliminar o ID <b>" + taskid + "</b>?"
  );
  $("#deletetask").modal("show");
});

// Remove task after conformation
$(document).on("click", "#confdelete", function () {
  var taskid = $("#taskdelid").val();
  $("div")
    .find("[data-taskid=" + taskid + "]")
    .remove();
  $("#deletetask").modal("hide");
});

function changeColor(id, c) {
  if (id == "ctxt") {
    $("#demotaak2").css("color", "#" + c);
  } else if (id == "cbg") {
    $("#demotaak1").css("border-left-color", "#" + c);
    $("#demotaak2").css("background-color", "#" + c);
  }
  return false;
}









(function() {
  'use strict';
  window.addEventListener('load', function() {
    // Fetch all the forms we want to apply custom Bootstrap validation styles to
    var forms = document.getElementsByClassName('needs-validation');
    // Loop over them and prevent submission
    var validation = Array.prototype.filter.call(forms, function(form) {
      form.addEventListener('submit', function(event) {
        if (form.checkValidity() === false) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      }, false);
    });
  }, false);
})();
</script>



</body>
</html>
